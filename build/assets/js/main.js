!function(){var t;t=function(t){var n,e,s,r,o,a,i,p,c;return c=6,p=5,e=!1,a=function(){return console.log("(gardencal) initialized"),i()},i=function(){return t.getJSON("garden.json",function(t){return console.log("JSON loaded"),s(t)})},s=function(n){var s;return t(".gardencal").html(Mustache.render(t("#template").html(),n)),e=t(".crops"),s=t(".crops li"),t(n.crops).each(function(){var n,e;return n=this.name,e=void 0,t(s).each(function(){return t(this).attr("data-crop")===n?e=this:void 0}),e?o(this,e):void 0}),e.css("width",5.2*n.crops.length+"rem")},o=function(t,n){var e,s,o,a,i;for(a=t.plantings.plant,i=[],s=0,o=a.length;o>s;s++)e=a[s],i.push(r(e,n,t));return i},r=function(e,s,r){var o,a,i,l,h,u,g,d,f;return a=['<span class="','">&nbsp;</span>'],d=e[0].split("-"),i=e[1].split("-"),f=(d[0]-1+d[1]/30)*p,o=(i[0]-1+i[1]/30)*p,g=t(a[0]+"plant"+a[1]).appendTo(s),g.css("top",f+c+"rem"),g.css("height",o-f+"rem"),g.data("start",e[0]),g.data("end",e[1]),n(g),h=f+c+r.plantings.harvest.after/30*p,l=o+c+r.plantings.harvest.after/30*p+r.plantings.harvest["for"]/30*p,g=t(a[0]+"harvest"+a[1]).appendTo(s),g.css("top",h+"rem"),g.css("height",l-h+"rem"),n(g),r.plantings.seedlings?(u=f+c-r.plantings.seedlings/30*p,g=t(a[0]+"seed"+a[1]).appendTo(s),g.css("top",u+"rem"),g.css("height",o+c-r.plantings.seedlings/30*p-u+"rem"),n(g)):void 0},n=function(n){var s,r,o;return t(n).offset().top+t(n).outerHeight()>e.offset().top+e.outerHeight()?(o=t(n).offset().top,s=e.offset().top,o>s+e.outerHeight()?(r=o-(s+e.outerHeight()),t(n).css("top",c+r/16+"rem")):console.log("@TODO handle spans that split across the new year")):void 0},{init:a}}(jQuery),$(function(){return t.init()})}.call(this);